---
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";

interface Props {
    imagePath: string;
    altText: string;
    TypeOfLoader: "eager" | "lazy";
}

const { imagePath, altText, TypeOfLoader } = Astro.props;

const images = import.meta.glob<{ default: ImageMetadata }>("/src/assets/*.{jpeg,jpg,png,gif,webp}");
if (!images[imagePath]) throw new Error(`"${imagePath}" does not exist en glob: "src/assets/*.{jpeg,jpg,png,gif,webp}"`);

const uniqueId = crypto.randomUUID();
---

<div class="w-60 h-80 bg-[#1F2937] p-3 flex flex-col gap-1 rounded-2xl" data-id={uniqueId}>
    <Image id={`dynamic-image-${uniqueId}`} src={images[imagePath]()} alt={altText} loading={TypeOfLoader} class="dynamic-image h-48 bg-white w-full rounded-xl mx-auto" />
    <div class="flex flex-col gap-4">
        <slot />
        <button id={`save-image-${uniqueId}`} class="save-image hover:bg-[#3B82F6] text-gray-50 bg-[#1850b9] py-2 rounded-md">Agregar al carrito</button>
    </div>
</div>

<script type="module" src="../src/ts/LocalStorageProducts.ts"></script>
